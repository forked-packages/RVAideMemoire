<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Significance test based on cross (model) validation — MVA.test • RVAideMemoire</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Significance test based on cross (model) validation — MVA.test" />

<meta property="og:description" content="Performs a permutation significance test based on cross (model) validation with different PLS and/or discriminant analyses. See MVA.cv and MVA.cmv for more details about how cross (model) validation is performed." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RVAideMemoire</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.73</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Significance test based on cross (model) validation</h1>
    
    <div class="hidden name"><code>MVA.test.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Performs a permutation significance test based on cross (model) validation with different PLS and/or discriminant analyses. See <code><a href='MVA.cv.html'>MVA.cv</a></code> and <code><a href='MVA.cmv.html'>MVA.cmv</a></code> for more details about how cross (model) validation is performed.</p>
    
    </div>

    <pre class="usage"><span class='fu'>MVA.test</span>(<span class='no'>X</span>, <span class='no'>Y</span>, <span class='kw'>cmv</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>kout</span> <span class='kw'>=</span> <span class='fl'>7</span>, <span class='kw'>kinn</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"PLSR"</span>, <span class='st'>"CPPLS"</span>, <span class='st'>"PLS-DA"</span>, <span class='st'>"PPLS-DA"</span>, <span class='st'>"LDA"</span>, <span class='st'>"QDA"</span>, <span class='st'>"PLS-DA/LDA"</span>,
  <span class='st'>"PLS-DA/QDA"</span>, <span class='st'>"PPLS-DA/LDA"</span>,<span class='st'>"PPLS-DA/QDA"</span>), <span class='kw'>Q2diff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>lower</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>Y.add</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>X</span>)), <span class='kw'>set.prior</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>crit.DA</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"plug-in"</span>, <span class='st'>"predictive"</span>, <span class='st'>"debiased"</span>), <span class='kw'>p.method</span> <span class='kw'>=</span> <span class='st'>"fdr"</span>,
  <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>a data frame of independent variables.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>the dependent variable(s): numeric vector, data frame of quantitative variables or factor.</p></td>
    </tr>
    <tr>
      <th>cmv</th>
      <td><p>a logical indicating if the values (Q2 or NMC) should be generated through cross-validation (classical K-fold process) or cross model validation (inner + outer loops).</p></td>
    </tr>
    <tr>
      <th>ncomp</th>
      <td><p>an integer giving the number of components to be used to generate all submodels (cross-validation) or the maximal number of components to be tested in the inner loop (cross model validation). Can be re-set internally if needed. Does not concern LDA and QDA.</p></td>
    </tr>
    <tr>
      <th>kout</th>
      <td><p>an integer giving the number of folds (cross-validation) or the number of folds in the outer loop (cross-model validation).  Can be re-set internally if needed.</p></td>
    </tr>
    <tr>
      <th>kinn</th>
      <td><p>an integer giving the number of folds in the inner loop (cross model validation only).  Can be re-set internally if needed. Cannot be <code>&gt; kout</code>.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>logical indicating if data should be scaled. See help of <code><a href='MVA.cv.html'>MVA.cv</a></code> and <code><a href='MVA.cmv.html'>MVA.cmv</a></code>.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>the model to be fitted.</p></td>
    </tr>
    <tr>
      <th>Q2diff</th>
      <td><p>the threshold to be used if the number of components is chosen according to Q2 (cross model validation only).</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>a vector of lower limits for power optimisation in CPPLS or PPLS-DA (see <code><a href='https://www.rdocumentation.org/packages/pls/topics/cppls.fit'>cppls.fit</a></code>).</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>a vector of upper limits for power optimisation in CPPLS or PPLS-DA (see <code><a href='https://www.rdocumentation.org/packages/pls/topics/cppls.fit'>cppls.fit</a></code>).</p></td>
    </tr>
    <tr>
      <th>Y.add</th>
      <td><p>a vector or matrix of additional responses containing relevant information about the observations, in CPPLS or PPLS-DA (see <code><a href='https://www.rdocumentation.org/packages/pls/topics/cppls.fit'>cppls.fit</a></code>).</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a vector of individual weights for the observations, in CPPLS or PPLS-DA (see <code><a href='https://www.rdocumentation.org/packages/pls/topics/cppls.fit'>cppls.fit</a></code>).</p></td>
    </tr>
    <tr>
      <th>set.prior</th>
      <td><p>only used when a LDA or QDA is performed (coupled or not with a PLS model). If <code>TRUE</code>, the prior probabilities of class membership are defined according to the mean weight of individuals belonging to each class. If <code>FALSE</code>, prior probabilities are obtained from the data sets on which LDA/QDA models are built.</p></td>
    </tr>
    <tr>
      <th>crit.DA</th>
      <td><p>criterion used to predict class membership when a LDA or QDA is used. See <code><a href='https://www.rdocumentation.org/packages/MASS/topics/predict.lda'>predict.lda</a></code>.</p></td>
    </tr>
    <tr>
      <th>p.method</th>
      <td><p>method for p-values correction. See help of <code><a href='https://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code>.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>number of permutations.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>logical indicating if the progress bar should be displayed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments to pass to <code><a href='https://www.rdocumentation.org/packages/pls/topics/mvr'>plsr</a></code> (PLSR, PLS-DA) or <code><a href='https://www.rdocumentation.org/packages/pls/topics/mvr'>cppls</a></code> (CPPLS, PPLS-DA).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When <code>Y</code> consists in quantitative response(s), the null hypothesis is that each response is not predicted better than what would happen by chance. In this case, Q2 is used as the test statistic. When <code>Y</code> contains several responses, a p-value is computed for each response and p-values are corrected for multiple testing.</p>
<p>When <code>Y</code> is a factor, the null hypothesis is that the factor has no discriminant ability. In this case, the classification error rate (NMC) is used as the test statistic.</p>
<p>Whatever the response, the reference value of the test statistics is obtained by averaging 20 values coming from independently performed cross (model) validation on the original data.</p>
<p>The function deals with the limitted floating point precision, which can bias calculation of p-values based on a discrete test statistic distribution.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>method</dt><dd><p>a character string indicating the name of the test.</p></dd>
  <dt>data.name</dt><dd><p>a character string giving the name(s) of the data, plus additional information.</p></dd>
  <dt>statistic</dt><dd><p>the value of the test statistics.</p></dd>
  <dt>permutations</dt><dd><p>the number of permutations.</p></dd>
  <dt>p.value</dt><dd><p>the p-value of the test.</p></dd>
  <dt>p.adjust.method</dt><dd><p>a character string giving the method for p-values correction.</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Westerhuis J, Hoefsloot HCJ, Smit S, Vis DJ, Smilde AK, van Velzen EJJ, van Duijnhoven JPM and van Dorsten FA (2008) Assessment of PLSDA cross validation. Metabolomics 4:81-89.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='MVA.cv.html'>MVA.cv</a></code>, <code><a href='MVA.cmv.html'>MVA.cmv</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>pls</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>MASS</span>)

<span class='co'># PLSR</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>yarn</span>)</div><span class='co'># NOT RUN {</span>
<span class='fu'>MVA.test</span>(<span class='no'>yarn</span>$<span class='no'>NIR</span>,<span class='no'>yarn</span>$<span class='no'>density</span>,<span class='kw'>cmv</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='st'>"PLSR"</span>)
<span class='co'># }</span><div class='input'>
<span class='co'># PPLS-DA coupled to LDA</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>mayonnaise</span>)</div><span class='co'># NOT RUN {</span>
<span class='fu'>MVA.test</span>(<span class='no'>mayonnaise</span>$<span class='no'>NIR</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>mayonnaise</span>$<span class='no'>oil.type</span>),<span class='kw'>model</span><span class='kw'>=</span><span class='st'>"PPLS-DA/LDA"</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Maxime Herv攼㸹 &lt;mx.herve@gmail.com&gt;</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Maxime Hervé.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

